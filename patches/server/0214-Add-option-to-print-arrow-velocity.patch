From d37352d194b4c76a01292b903aa7105fdf847f2d Mon Sep 17 00:00:00 2001
From: halfmaster1 <ohpointfive@gmail.com>
Date: Mon, 30 Aug 2021 14:47:56 -0400
Subject: [PATCH] Add option to print arrow velocity


diff --git a/src/main/java/net/minecraft/server/EntityArrow.java b/src/main/java/net/minecraft/server/EntityArrow.java
index 4239fd89..45e79605 100644
--- a/src/main/java/net/minecraft/server/EntityArrow.java
+++ b/src/main/java/net/minecraft/server/EntityArrow.java
@@ -244,7 +244,11 @@ public class EntityArrow extends Entity implements IProjectile {
             if (movingobjectposition != null) {
                 org.bukkit.craftbukkit.event.CraftEventFactory.callProjectileHitEvent(this); // CraftBukkit - Call event
                 if (movingobjectposition.entity != null) {
-                    f2 = Math.min(PaperSpigotConfig.maximumArrowVelocity, MathHelper.sqrt(this.motX * this.motX + this.motY * this.motY + this.motZ * this.motZ));
+                    float arrowVelocity = MathHelper.sqrt(this.motX * this.motX + this.motY * this.motY + this.motZ * this.motZ);
+                    if (PaperSpigotConfig.printArrowVelocity) {
+                        org.bukkit.Bukkit.broadcastMessage("Velocity: " + arrowVelocity);
+                    }
+                    f2 = Math.min(PaperSpigotConfig.maximumArrowVelocity, arrowVelocity);
                     float k = f2 * (float) this.damage * PaperSpigotConfig.arrowDamageMultiplier;
 
                     if (this.isCritical() && PaperSpigotConfig.includeRandomnessInArrowDamage) { // SportPaper
diff --git a/src/main/java/org/github/paperspigot/PaperSpigotConfig.java b/src/main/java/org/github/paperspigot/PaperSpigotConfig.java
index d913e42e..004d980b 100644
--- a/src/main/java/org/github/paperspigot/PaperSpigotConfig.java
+++ b/src/main/java/org/github/paperspigot/PaperSpigotConfig.java
@@ -153,6 +153,11 @@ public class PaperSpigotConfig
         printDamage = getBoolean("settings.print-damage", printDamage);
     }
 
+    public static boolean printArrowVelocity = false;
+    private static void printArrowVelocity() {
+        printArrowVelocity = getBoolean("settings.print-arrow-velocity", printArrowVelocity);
+    }
+
     public static boolean tickEmptyWorlds = true;
     private static void tickEmptyWorlds() {
         tickEmptyWorlds = getBoolean("settings.tick-empty-worlds", tickEmptyWorlds);
-- 
2.29.2

